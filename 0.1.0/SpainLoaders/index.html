<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Loading Spain Buildings · CompositeBuildings.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link rel="canonical" href="https://SuperGrobi.github.io/CompositeBuildings.jl/SpainLoaders/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">CompositeBuildings.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li class="is-active"><a class="tocitem" href>Loading Spain Buildings</a><ul class="internal"><li><a class="tocitem" href="#Introduction"><span>Introduction</span></a></li><li><a class="tocitem" href="#Usage-example"><span>Usage example</span></a></li><li><a class="tocitem" href="#API"><span>API</span></a></li></ul></li><li><a class="tocitem" href="../OtherLoaders/">Loading Buildings</a></li><li><a class="tocitem" href="../ShadowCasting/">Shadow Casting</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Loading Spain Buildings</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Loading Spain Buildings</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/SuperGrobi/CompositeBuildings.jl/blob/main/docs/src/SpainLoaders.md#" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Spain-Building-Loaders-and-Utilities"><a class="docs-heading-anchor" href="#Spain-Building-Loaders-and-Utilities">Spain Building Loaders and Utilities</a><a id="Spain-Building-Loaders-and-Utilities-1"></a><a class="docs-heading-anchor-permalink" href="#Spain-Building-Loaders-and-Utilities" title="Permalink"></a></h1><h2 id="Introduction"><a class="docs-heading-anchor" href="#Introduction">Introduction</a><a id="Introduction-1"></a><a class="docs-heading-anchor-permalink" href="#Introduction" title="Permalink"></a></h2><p>Spain provides easy access to their cadastral dataset of building footprints and metadata. We provide some functions to inspect, download, preprocess and load the available data.</p><p>The returned <code>DataFrames</code> conform to the requirements needed to be a source for building data.</p><h2 id="Usage-example"><a class="docs-heading-anchor" href="#Usage-example">Usage example</a><a id="Usage-example-1"></a><a class="docs-heading-anchor-permalink" href="#Usage-example" title="Permalink"></a></h2><h2 id="API"><a class="docs-heading-anchor" href="#API">API</a><a id="API-1"></a><a class="docs-heading-anchor-permalink" href="#API" title="Permalink"></a></h2><ul><li><a href="#CompositeBuildings.download_spain_overview"><code>CompositeBuildings.download_spain_overview</code></a></li><li><a href="#CompositeBuildings.download_spain_region_overview"><code>CompositeBuildings.download_spain_region_overview</code></a></li><li><a href="#CompositeBuildings.download_spain_subregion"><code>CompositeBuildings.download_spain_subregion</code></a></li><li><a href="#CompositeBuildings.load_spain_buildings_gml"><code>CompositeBuildings.load_spain_buildings_gml</code></a></li><li><a href="#CompositeBuildings.load_spain_parts_gml"><code>CompositeBuildings.load_spain_parts_gml</code></a></li><li><a href="#CompositeBuildings.load_spain_processed_buildings"><code>CompositeBuildings.load_spain_processed_buildings</code></a></li><li><a href="#CompositeBuildings.parse_polygon_string"><code>CompositeBuildings.parse_polygon_string</code></a></li><li><a href="#CompositeBuildings.parse_spain_xml"><code>CompositeBuildings.parse_spain_xml</code></a></li><li><a href="#CompositeBuildings.preprocess_spain_subregion"><code>CompositeBuildings.preprocess_spain_subregion</code></a></li><li><a href="#CompositeBuildings.relate_floors"><code>CompositeBuildings.relate_floors</code></a></li></ul><h3 id="Inspect-datasets"><a class="docs-heading-anchor" href="#Inspect-datasets">Inspect datasets</a><a id="Inspect-datasets-1"></a><a class="docs-heading-anchor-permalink" href="#Inspect-datasets" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-binding" id="CompositeBuildings.parse_polygon_string" href="#CompositeBuildings.parse_polygon_string"><code>CompositeBuildings.parse_polygon_string</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">parse_polygon_string(polystring)</code></pre><p>parses a string of the form <code>&quot;lat1 lon1 lat2 lon2...&quot;</code> or <code>&quot;lat1\tlon1\tlat2\tlon2...&quot;</code> into an <code>ArchGDAL</code> polygon.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SuperGrobi/CompositeBuildings.jl/blob/876b81c3ffe9d406a63241350e5640d85ab29ba8/src/SpainLoaders.jl#L1-L6">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CompositeBuildings.parse_spain_xml" href="#CompositeBuildings.parse_spain_xml"><code>CompositeBuildings.parse_spain_xml</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">parse_spain_xml(url)</code></pre><p>Reads an XML Document from the Spanish Cadastral Dataset (see <a href="https://www.catastro.minhap.es/INSPIRE/buildings/ES.SDGC.BU.atom.xml">here</a> for an example) and parses it into a dataframe containing information about the regions described within it.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SuperGrobi/CompositeBuildings.jl/blob/876b81c3ffe9d406a63241350e5640d85ab29ba8/src/SpainLoaders.jl#L20-L25">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CompositeBuildings.download_spain_overview" href="#CompositeBuildings.download_spain_overview"><code>CompositeBuildings.download_spain_overview</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">download_spain_overview()</code></pre><p>Downloads and parses the xml file at https://www.catastro.minhap.es/INSPIRE/buildings/ES.SDGC.BU.atom.xml</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SuperGrobi/CompositeBuildings.jl/blob/876b81c3ffe9d406a63241350e5640d85ab29ba8/src/SpainLoaders.jl#L46-L50">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CompositeBuildings.download_spain_region_overview" href="#CompositeBuildings.download_spain_region_overview"><code>CompositeBuildings.download_spain_region_overview</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">download_spain_region_overview(region_id, spain_overview=download_spain_overview())</code></pre><p>Downloads and parses the xml corresponding to the <code>region_id</code> from the cadastral dataset. Can optionally take the result from <code>download_spain_overview()</code>, to reduce the number of server calls.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SuperGrobi/CompositeBuildings.jl/blob/876b81c3ffe9d406a63241350e5640d85ab29ba8/src/SpainLoaders.jl#L56-L61">source</a></section></article><h3 id="Download-and-process"><a class="docs-heading-anchor" href="#Download-and-process">Download and process</a><a id="Download-and-process-1"></a><a class="docs-heading-anchor-permalink" href="#Download-and-process" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-binding" id="CompositeBuildings.download_spain_subregion" href="#CompositeBuildings.download_spain_subregion"><code>CompositeBuildings.download_spain_subregion</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">download_spain_subregion(url, savepath)</code></pre><p>Downloads the zip file at <code>url</code> (element of <code>download_spain_region_overview(...).url</code>) to <code>savepath.zip</code>, extracts it to <code>savepath/raw</code>, and deletes the zip file.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SuperGrobi/CompositeBuildings.jl/blob/876b81c3ffe9d406a63241350e5640d85ab29ba8/src/SpainLoaders.jl#L67-L72">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CompositeBuildings.load_spain_buildings_gml" href="#CompositeBuildings.load_spain_buildings_gml"><code>CompositeBuildings.load_spain_buildings_gml</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">load_spain_buildings_gml(path; extent=nothing)</code></pre><p>Loads the file at <code>path</code> with <code>GeoDataFrames</code>, and applies some transformations that only make sense if it is a buildings file from the spanish cadastral dataset.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SuperGrobi/CompositeBuildings.jl/blob/876b81c3ffe9d406a63241350e5640d85ab29ba8/src/SpainLoaders.jl#L86-L91">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CompositeBuildings.load_spain_parts_gml" href="#CompositeBuildings.load_spain_parts_gml"><code>CompositeBuildings.load_spain_parts_gml</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">load_spain_parts_gml(path; extent=nothing)</code></pre><p>Loads the file at <code>path</code> with <code>GeoDataFrames</code>, and applies some transformations that only make sense if it is a buildingparts file from the spanish cadastral dataset.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SuperGrobi/CompositeBuildings.jl/blob/876b81c3ffe9d406a63241350e5640d85ab29ba8/src/SpainLoaders.jl#L131-L136">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CompositeBuildings.relate_floors" href="#CompositeBuildings.relate_floors"><code>CompositeBuildings.relate_floors</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">relate_floors(buildings, buildings_parts)</code></pre><p>Infers the number of floors a building in <code>buildings</code> might have, given the data present in its constituent <code>buildings_parts</code> by various different methods:</p><ul><li><code>nFloors_overlap</code>: average number of floors in all parts, weighed by intersection area (overlap) between each part and the building.</li><li><code>nFloors_approx</code>: given <code>area</code> in the dataset divided by area of the footprint (<code>myArea</code>). Assumes that <code>area</code> is a &quot;usable area&quot;.</li><li><code>nFloors_part_approx</code>: given <code>area</code> in the dataset divided by the total footprint-area of all parts (<code>myArea_part</code>). Assumes that the given area is some kind of &quot;usable area&quot;.</li><li><code>maxFloors_part</code>: maximum value of floors in all parts associated with building.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SuperGrobi/CompositeBuildings.jl/blob/876b81c3ffe9d406a63241350e5640d85ab29ba8/src/SpainLoaders.jl#L156-L165">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CompositeBuildings.preprocess_spain_subregion" href="#CompositeBuildings.preprocess_spain_subregion"><code>CompositeBuildings.preprocess_spain_subregion</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">preprocess_spain_subregion(path; extent=nothing)</code></pre><p>Loads buildings and building parts form <code>path/raw</code>, and save the result of <code>relate_floors(...)</code> to <code>path/buildings.geojson</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SuperGrobi/CompositeBuildings.jl/blob/876b81c3ffe9d406a63241350e5640d85ab29ba8/src/SpainLoaders.jl#L189-L193">source</a></section></article><h3 id="Load"><a class="docs-heading-anchor" href="#Load">Load</a><a id="Load-1"></a><a class="docs-heading-anchor-permalink" href="#Load" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-binding" id="CompositeBuildings.load_spain_processed_buildings" href="#CompositeBuildings.load_spain_processed_buildings"><code>CompositeBuildings.load_spain_processed_buildings</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">load_spain_processed_buildings(path; extent=nothing, floor_height=4.0)</code></pre><p>loads the files saved by <code>preprocess_spain_subregion(...)</code> from <code>path/buildings.geojson</code> and adds metadata for projection.</p><p>Uses <code>floor_height</code> to convert <code>nFloor_overlap</code> to building height.</p><p>The returned <code>DataFrame</code> fulfills the requirements to be used as a source for building data.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SuperGrobi/CompositeBuildings.jl/blob/876b81c3ffe9d406a63241350e5640d85ab29ba8/src/SpainLoaders.jl#L207-L215">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Home</a><a class="docs-footer-nextpage" href="../OtherLoaders/">Loading Buildings »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Tuesday 19 March 2024 19:10">Tuesday 19 March 2024</span>. Using Julia version 1.10.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
